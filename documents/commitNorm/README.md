# git 版本管理规范

git 版本管理主要从以下几个方面来制定规范。
1. commit message 规范
2. tag 标签管理
3. 统一的changelog 文件信息
4. 分支管理


## commit message 规范
每个 commit message 包含一个 header, 一个 body 和一个 footer。header由 type，scope，subject 组成。header中的 type 和 subject 是必填的，scope 选填。body 和 footer 选填。

```
<type>(<scope>): <subject>
<BLANK LINE>
<body>
<BLANK LINE>
<footer>
```

### Type
* feat: 新功能
* fix: 在提测或者上线之后修复的bug
* docs: 仅仅修改了文档.如：README,CHANGELOG等
* style: 修改代码风格.如：修改了缩进，空格，逗号；增加，修改，删除了注释；删除多余的文件；删除console.log等
* refactor: 代码重构，没有新增功能也没有修复bug
* pref: 性能优化
* test: 修改测试用例。如单元测试，集成测试等
* revert: 回滚到某个版本
* chore: 改变构建流程，增加了依赖库或修改了配置文件等
### Scope
在scope中指定本次变更修改的文件
### 格式要求

```
# header：52个字符以内，描述主要变更内容
#
# body：更详细的说明文本，建议72个字符以内。 需要描述的信息包括:
#
# * 为什么这个变更是必须的? 它可能是用来修复一个bug，增加一个feature，提升性能、可靠性、稳定性等等
# * 他如何解决这个问题? 具体描述解决问题的步骤
# * 是否存在副作用、风险? 
#
# footer：如果需要的化可以添加一个链接到issue地址，或者关闭某个issue。
```
例子：

```
feat(app.css): 去掉所有a标签的下划线

由于UI改版，所有去掉系统中所有a标签的下划线
```

### 不符合规定格式的日志拒绝提交
使用 commitlint 和 husky 验证并限制 commit message.
### commit 类型选择提示
使用 commitizen 工具
## tag 标签管理 
tag标签管理分为三种情况，产品没有明确的版本概念，产品有明确的版本的概览，工具库或者UI组件库的开发。
### 工具库或UI组件库的开发
版本格式：主版本号.次版本号.修订号（X.Y.Z），版本号递增规则如下：

* 主版本号：当你做了不兼容的 API 修改，
* 次版本号：当你做了向下兼容的功能性新增，
* 修订号：当你做了向下兼容的问题修正。

版本控制规范
1. 标准的版本号必须采用X.Y.Z的格式，其中X.Y.Z为非负整数，禁止在数字前方补零，X 是主版本号、Y 是次版本号、而 Z 为修订号。
2. 标记版本号的工具库或者UI组件库发发行后，禁止修改该版本的内容，任何修改必须以新版本发行。
3. 主版本号为0时，表示此时处于初始开发阶段，一切都可能随时被改变，此时工具库或者UI组件库还不稳定。
4. 1.0.0的版本号用于界定稳定版形成。
5. 修订号Z必须在做了向下兼容的修改时才能递增，这里的修改指的是针对不正确结果而进行的内部修改。
6. 次版本号 Y 必须在有向下兼容的新功能出现时递增。也可以在内部程序有大量改进被加入时递增，其中可以包括修订级别的改变。每当次版本号递增时，修订号必须（MUST）归零。 
7. 主版本号 X必须在有任何不兼容的修改被加入时递增。其中可以包括次版本号及修订级别的改变。每当主版本号递增时，次版本号和修订号必须（MUST）归零。  
### 产品有明确的版本概念
版本格式与产品的版本一致，如果版本发布之后有修订版就在版本后面加上后缀，用中划线分隔，fix后面加上次数，即第几次fix。例如: v1.2.4   v1.2.4-fix1
### 产品没有明确的版本概念
个人觉得tag的作用之一是以便回退到此版本，所以在产品没有明确版本的概念时以本期大的功能修改作为版本号，不管是小程序，单页应用还是多页应用，都会涉及到路由，所以使用路由的简称作为版本，如果涉及到多个功能模版的修改，多个模块以点(.)分割，最多不超过两个点(.)，如果版本发布之后有修订版就在版本后面加上后缀，用中划线分隔，fix后面加上次数，即第几次fix。例如：userDetail.home.depDetail userDetail.home.depDetail-fix1  

版本发布之前打tag，如果在本次打tag之后有修改则根据实际情况版本递增。
## 禁止的操作
1. 禁止在团队公共分支上执行git push -f 操作
2. 禁止在团队公共分支执行git base变基操作，团队的公共分支的变更记录只能往前走，不能历史的变更记录
3. 禁止在团队公共分支执行git reset 操作回滚，使用git revert 进行代码回滚

## git的基本概念
1. git中三大对象commit , tree 和 blob
2. 分离头指针
3. 变基

## git的操作
1. 配置git
2. 修改commit message 信息
3. 回退版本
4. 打标签
